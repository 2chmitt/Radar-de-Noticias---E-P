<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Radar Petr√≥leo Brasil</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/static/imagem1.png">

    <!-- CSS -->
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<header class="header">
    <div class="logo">üõ¢ Radar Petr√≥leo Brasil</div>

    <div class="controls">

        <select id="periodoSelect" class="select-periodo">
            <option value="1">Hoje</option>
            <option value="2">√öltimos 2 dias</option>
            <option value="3">√öltimos 3 dias</option>
            <option value="4">√öltimos 4 dias</option>
            <option value="5">√öltimos 5 dias</option>
            <option value="6">√öltimos 6 dias</option>
            <option value="7" selected>√öltimos 7 dias</option>
            <option value="15">√öltimos 15 dias</option>
            <option value="30">√öltimos 30 dias</option>
            <option value="60">√öltimos 60 dias</option>
        </select>

        <button id="buscarBtn" class="btn-primary">
            Atualizar Not√≠cias
        </button>

    </div>
</header>

<main class="container">
    <div id="info"></div>
    <div id="resultado" class="grid"></div>
</main>

<script>
document.getElementById("buscarBtn").addEventListener("click", async () => {

    const resultadoDiv = document.getElementById("resultado");
    const infoDiv = document.getElementById("info");

    // üî• Garantir que √© n√∫mero
    const dias = parseInt(document.getElementById("periodoSelect").value);

    resultadoDiv.innerHTML = "";
    infoDiv.innerHTML = "Buscando not√≠cias...";

    try {
        const response = await fetch(`/buscar-noticias?dias=${dias}`);
        const data = await response.json();

        infoDiv.innerHTML = `
            Per√≠odo: ${data.periodo} |
            Total encontrado: ${data.quantidade}
        `;

        data.noticias.forEach(noticia => {

            const card = document.createElement("div");
            card.classList.add("card");

            if (noticia.relevancia >= 6) {
                card.classList.add("card-high");
            } else if (noticia.relevancia >= 3) {
                card.classList.add("card-medium");
            }

            card.innerHTML = `
                <div class="card-date">${noticia.data}</div>
                <div class="card-title">${noticia.titulo}</div>
                <div class="card-source">${noticia.fonte}</div>
                <div class="card-relevancia">Relev√¢ncia: ${noticia.relevancia}</div>
                <a href="${noticia.link}" target="_blank" rel="noopener noreferrer">
                    Ler mat√©ria completa ‚Üí
                </a>
            `;

            resultadoDiv.appendChild(card);
        });

    } catch (error) {
        infoDiv.innerHTML = "Erro ao buscar not√≠cias.";
    }

});
</script>

</body>
</html>
